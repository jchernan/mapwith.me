<html> 
  <head>
    <link rel="stylesheet" href="http://code.leafletjs.com/leaflet-0.3.1/leaflet.css" />
    <script src="http://code.leafletjs.com/leaflet-0.3.1/leaflet.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.js"></script>
    <link href="bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 40px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <title>Map Application</title>
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="#">Maps</a>
          <div class="btn-group pull-right">
            <input type="text" class="input-medium search-query">
          </div>
          <!--form>
            <input type="text" class="input-medium search-query">
            <button type="submit" class="btn">Search</button>
          </form-->
        </div>
      </div>
    </div>
    
    <div id="map" style="height: 800px"> </div>

    <script>
      var tileStreamServer = "http://www.aeternitatis.org:8888";
      var addressServer = "http://www.aeternitatis.org/map_find";
      var url = tileStreamServer + "/v2/boston/{z}/{x}/{y}.png";

      tileLayer = new L.TileLayer(url, {maxZoom: 18, minZoom:11});

      var map = new L.Map("map");
      var defaultCenter = new L.LatLng(42.3605, -71.0593); // default center point
      var defaultZoom = 13;

      var address = { "address": "77 Massachusetts Avenue, Cambridge, MA, 02139" };

      $.getJSON(addressServer, address, function(data) {
        for (var i=0; i < data.length ; i++){
          var point = data[i];
          var markerLoc = new L.LatLng(point.latitude, point.longitude);
          var marker = new L.Marker(markerLoc);
          map.addLayer(marker);
          map.setView(markerLoc, 15).addLayer(tileLayer);
        }
      })
      .error(function(data) {
        // if there is an error, set view at the default center point
        map.setView(defaultCenter, defaultZoom).addLayer(tileLayer);
        console.log("Error: " + data.statusText); 
        console.log("Response text: " + data.responseText);
      });

    </script>
   
    <script src="bootstrap.js"></script> 
  
  </body>
</html>
